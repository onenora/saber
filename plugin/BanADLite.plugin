#!name=BanADLite
#!desc=自用的广告过滤器(酷安,起点,微博)
#!homepage=https://ikuns.netlify.app
#!author=ikun[https://ikuns.netlify.app/en-us/links/]
#!tag=去广告
#!loon_version=3.2.4(787)
#!icon=https://ikuns.netlify.app/img/logo.png
#!date=2025-09-18

[MITM]
hostname = %APPEND% api.coolapk.com, api-access.pangolin-sdk-toutiao.com, magev6.if.qidian.com, bootpreload.uve.weibo.com, weibointl.api.weibo.cn, api.weibo.cn, business-cdn.shouji.sogou.com, mp.weixin.qq.com, szextshort.weixin.qq.com, static.zhihu.com, ems.youku.com, optimus-ads.amap.com, api.bilibili.com, app.bilibili.com, api.m.jd.com,img*.360buyimg.com

[Rewrite]
# -----酷安去首页广告、信息流广告、评论广告@kelee @ddgksf2013----------
^https:\/\/api\.coolapk\.com\/v6\/feed\/detail\? response-body-json-jq 'if .data?.hotReplyRows? and (.data.hotReplyRows|type)=="array" and (.data.hotReplyRows|length>0) then .data.hotReplyRows |= map(select(.id?)) else . end | if .data?.topReplyRows? and (.data.topReplyRows|type)=="array" and (.data.topReplyRows|length>0) then .data.topReplyRows |= map(select(.id?)) else . end | reduce ("detailSponsorCard","include_goods","include_goods_ids") as $key (.; .data[$key]=[])'
^https:\/\/api\.coolapk\.com\/v6\/feed\/replyList response-body-json-jq 'if (.data? and (.data|type)=="array" and (.data|length>0)) then .data |= map(select(.id?)) else . end'
^https:\/\/api\.coolapk\.com\/v6\/main\/dataList response-body-json-jq 'if (.data? and (.data|type)=="array" and (.data|length>0)) then .data |= map(select((.entityTemplate?!="sponsorCard") and (.title?!="精选配件"))) else . end'
^https:\/\/api\.coolapk\.com\/v6\/page\/dataList response-body-json-jq 'if (.data? and (.data|type)=="array" and (.data|length>0)) then .data |= map(select((.title?!="酷安热搜") and (.entityTemplate?!="imageScaleCard") and (.entityTemplate?!="sponsorCard"))) else . end'
^https:\/\/api\.coolapk\.com\/v6\/main\/indexV8 response-body-json-jq 'if (.data? and (.data|type)=="array" and (.data|length>0)) then .data |= map(select((.entityTemplate?!="sponsorCard") and ((.entityId // 0) as $id | [8639,29349,33006,32557] | index($id) | not) and ((.title // "" | test("值得买|红包")) | not))) else . end'
^https:\/\/api\.coolapk\.com\/v6\/main\/init response-body-json-jq 'if (.data? and (.data|type)=="array" and (.data|length>0)) then .data |= map(select((.entityId? | [944,945,6390] | index(.) | not)) | if .entityId==20131 and (.entities? and (.entities|type)=="array") then .entities |= map(select(.title?!="酷品")) else . end) else . end'
^https:\/\/api\.coolapk\.com\/v6\/search\?.*type=hotSearch - reject-dict
^https?://api-access\.pangolin-sdk-toutiao\.com/api/ad/union/sdk - reject

# ----------- 起点去广告 & 核心增强 @kelee @app2smile-----------
^https:\/\/magev6\.if\.qidian\.com\/argus\/api\/v1\/client\/getconf$ response-body-json-replace Data.WolfEye 0 Data.CloudSetting.TeenShowFreq 0 Data.EnableSearchUser "1"
^https:\/\/magev6\.if\.qidian\.com\/argus\/api\/v1\/client\/getconf$ response-body-json-del Data.ActivityPopup Data.ActivityIcon Data.LuckBag
^https:\/\/magev6\.if\.qidian\.com\/argus\/api\/v4\/client\/getsplashscreen\? - reject-dict
^https:\/\/magev6\.if\.qidian\.com\/argus\/api\/v2\/dailyrecommend\/getdailyrecommend\? response-body-json-replace Data.Items []
^https:\/\/magev6\.if\.qidian\.com\/argus\/api\/v1\/bookshelf\/getHoverAdv - reject-dict
^https:\/\/magev6\.if\.qidian\.com\/argus\/api\/v1\/adv\/getadvlistbatch\?positions=iOS_tab response-body-json-replace Data.iOS_tab []

#微博轻享版移除开屏广告、时间线广告及评论区广告，移除发现页面横幅推广、及热门视频@kelee
^https:\/\/weibointl\.api\.weibo\.cn\/portal\.php\?a=trends response-body-json-del data.banner data.profile_accessrecord data.native_content
^https:\/\/weibointl\.api\.weibo\.cn\/portal\.php\?a=trends response-body-json-jq '.data.discover |= map(select(.schema != "尊享会员"))'
^https:\/\/api\.weibo\.cn\/2\/statuses\/friends\/timeline$ response-body-json-del advertises ad ad_version_2_weibo
^https:\/\/api\.weibo\.cn\/2\/statuses\/friends\/timeline$ response-body-json-jq '.statuses|=map(select(.ad_marked!=true))'
^https:\/\/api\.weibo\.cn\/2\/statuses\/unread_hot_timeline$ response-body-json-del ad ad_version_2_weibo
^https:\/\/api\.weibo\.cn\/2\/statuses\/unread_hot_timeline$ response-body-json-jq '.statuses|=map(select(.ad_marked!=true))'
^https:\/\/api\.weibo\.cn\/2\/comments\/build_comments\? response-body-json-jq '.datas[].data.ad_from_comment? = true'
^https:\/\/api\.weibo\.cn\/2\/cardlist\?aid= response-body-json-jq '.cards |= map(select((.mblog?|(.ad_marked?|type=="boolean")and.ad_marked==true)or(.card_group?|type=="array"and any(.[]?;.mblog?|(.ad_marked?|type=="boolean")and.ad_marked==true))|not))'
^https:\/\/bootpreload\.uve\.weibo\.com\/v1\/ad\/preload$ - reject-dict
^https:\/\/api\.weibo\.cn\/2\/cardlist\?v_f=2 - reject-dict
^https:\/\/api\.weibo\.cn\/2\/ad\/ - reject-dict

# > 🈲️搜狗输入法搜集信息
^https?+:\/\/business-cdn\.shouji\.sogou\.com\/wapdl\/hole\/.+?\.jpg - reject-200

# >微信公众号文章下方广告
^https?:\/\/mp\.weixin\.qq.com\/mp\/ad_complaint - reject
^https?:\/\/szextshort\.weixin\.qq\.com\/cgi-bin\/mmoc-bin\/ad\/ - reject-img
^https?:\/\/mp\.weixin\.qq.com\/mp\/ad_video - reject
^https?:\/\/mp\.weixin\.qq.com\/mp\/advertisement_report - reject
^https?:\/\/mp\.weixin\.qq\.com\/(s|mp)\/(ad_|advertisement|getappmsgad|report|appmsgreport|appmsgpicreport) - reject-img
^https?:\/\/mp\.weixin\.qq\.com\/mp\/(ad_|advertisement|getappmsgad) - reject
^https?+:\/\/mp\.weixin\.qq\.com\/mp\/(?>ad_|advertisement|getappmsgad) - reject-200

# > 知乎网页版强制登陆弹窗@HotKids
^https?:\/\/static\.zhihu\.com\/[^\/]+\/(main|column)\.signflow\.[^.]+.js - reject

#高德地图广告ems
^http:\/\/ems\.youku\.com\/imp\? - reject
^http:\/\/optimus-ads\.amap\.com\/uploadimg\/.+ - reject

# ～ BiliBili_小卡片广告,开屏页广告@ddgksf2013
^https://api.bilibili.com/pgc/season/player/cards - reject-dict
^https?:\/\/api\.bilibili\.com\/pgc\/season\/app\/related\/recommend\? - reject-dict
^https://app.bilibili.com/x/v2/splash/show - reject-dict

# > JD 京东开屏广告（此条规则会影响京东比价显示,使其失效）
^https?:\/\/api\.m\.jd.com\/client\.action\?functionId=start - reject
^https?:\/\/api\.m\.jd.com\/client\.action\?functionId=queryMaterialAdverts - reject
^https?:\/\/(bdsp-x|dsp-x)\.jd\.com\/adx\/ - reject
^https?:\/\/img\d+\.360buyimg\.com\/jddjadvertise\/ - reject

